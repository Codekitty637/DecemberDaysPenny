:root {
  /* Penny theme colors */
  --penny-red-light: #FF3B30;
  --penny-red-mid: #D62828;
  --penny-red-dark: #A01012;

  --penny-black: #000000;
  --penny-black-soft: #0D0D0D;
  --penny-charcoal: #1A1A1A;
  --penny-graphite: #2E2E2E;

  --penny-glow-blood: #FF4D4F;
  --penny-glow-cursed: #F5426C;
  --penny-ember: #FF6A3D;

  --penny-white: #FFFFFF;

  /* existing font tokens */
  --font-sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    "Apple Color Emoji", "Segoe UI Emoji";
  --font-serif: Georgia, "Times New Roman", serif;
}

/* ===== Base & global guards ===== */
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; }
html { overflow-x: hidden; }                   /* kill sideways scroll globally */
body{
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-sans);
  scrollbar-gutter: stable both-edges;        /* avoid 100vw overflow when scrollbar shows */
}

/* Fluid media defaults */
img, video, canvas, svg { max-width: 100%; height: auto; display: block; }

/* Helper: full-bleed safely inside padded parents */
.fullBleed { width: 100%; max-width: 100%; }

/* ===== Layout wrappers ===== */
.container{
  /* page padding that scales with viewport */
  --pad-x: clamp(12px, 4vw, 24px);
  --pad-y: clamp(16px, 5vw, 32px);
  min-height: 100dvh;
  display: flex;
  justify-content: center;
  padding-inline: var(--pad-x);
  padding-block: var(--pad-y);
  background:
    radial-gradient(1000px 600px at 120% -10%, rgba(15,23,42,0.06) 0%, rgba(15,23,42,0) 55%),
    radial-gradient(800px 500px at -10% -20%, rgba(202,165,87,0.06) 0%, rgba(202,165,87,0) 60%),
    var(--bg);
}

/* Page content never exceeds max, auto-centers */
.page {
  width: 100%;
  max-width: 980px;                          /* hard cap stops “growing” */
  margin-inline: auto;
  display: grid;
  gap: 28px;
}

/* Prevent stray horizontal scroll at common wrappers */
html, body, .container, .page { overflow-x: hidden; }

/* ===== Flex/Grid overflow safeties ===== */
/* Let text wrap instead of stretching its parent in flex/grid rows */
.flexRow, .gridRow { min-width: 0; }
.flexRow > *, .gridRow > * { min-width: 0; }

/* Generic utilities you can apply anywhere */
.noScrollX { overflow-x: hidden !important; }
.wrapText {
  overflow-wrap: anywhere;
  word-break: break-word;
  hyphens: auto;
}

/* ===== Progress ===== */
.progress {
  background: #fff;
  border: 1px solid var(--line);
  border-radius: 16px;
  padding: 28px 18px;
  margin-bottom: 18px;
  overflow: hidden;                          /* clip any accidental spill */
}
.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 600;
  color: var(--navy);
  margin: 0 0 14px;
}
.progress-track {
  position: relative;
  height: 10px;
  background: #f1f5f9;
  border-radius: 999px;
  border: 1px solid #e5e7eb;
  overflow: visible;
  margin-bottom: 16px;
}
.progress-fill {
  position:absolute; left:0; top:0; bottom:0; width:0%;
  background: linear-gradient(90deg, #caa557, #a88a41);
  border-right:1px solid rgba(0,0,0,0.06);
  transition: width 520ms cubic-bezier(.22,1,.36,1);
}

/* Filmstrip milestone marks centered over the track */
.progress-marks {
  position: absolute;
  left: 12px; right: 12px;
  top: 50%; transform: translateY(-50%);
  height: 36px;
  pointer-events: none;
  z-index: 2;
}
.progress .mark {
  position: absolute;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 36px; height: 36px; border-radius: 999px;
  display: grid; place-items: center;
  pointer-events: auto;
  transition: transform 160ms ease, filter 160ms ease, opacity 160ms ease;
}
.progress .mark img { width: 100%; height: 100%; object-fit: contain; }
.progress .mark.mark-last { width: 40px; height: 40px; }

/* States */
.progress .mark.mark-unlocked { filter: none; opacity: 1; }
.progress .mark.mark-current  { filter: drop-shadow(0 6px 12px rgba(202,165,87,.35)); transform: translate(-50%, -50%) scale(1.08); }
.progress .mark.mark-locked   { filter: grayscale(1) opacity(.55); }

/* ===== Banner ===== */
.banner{
  background: linear-gradient(180deg, #fff, #fdfdfd);
  border: 1px solid var(--line);
  border-radius: 16px;
  position: relative;
}
.banner::before{
  content:''; position:absolute; inset:0; border-radius:16px;
  background: linear-gradient(90deg, rgba(202,165,87,0.25), rgba(15,23,42,0.12) 70%, transparent);
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  padding:1px; pointer-events:none; opacity:.6;
}
.banner-inner{ padding:22px; }
.banner-header { display: flex; align-items: center; gap: 14px; }
.banner-logo { width: 48px; height: 48px; object-fit: contain; border-radius: 8px; flex-shrink: 0; }
.banner-text { display: flex; flex-direction: column; justify-content: center; }
.banner .rule {
  width: 100px; height: 2px;
  background: linear-gradient(90deg, var(--gold), transparent);
  margin: 4px 0 6px; border-radius: 2px;
}
.banner-title{
  margin:0 0 6px;
  font-family: var(--font-serif);
  font-size: clamp(24px, 3vw, 32px);
  letter-spacing:.2px; color: var(--navy-ink);
}
.banner-sub{ margin:0; color: var(--muted); }
@media (max-width: 600px) {
  .banner-header { gap: 10px; }
  .banner .rule { width: 80px; }
}

/* ===== Hero (video + text) ===== */
.hero{
  display:grid;
  grid-template-columns: 1.15fr 1fr;
  gap:22px; align-items:center;
  border: 1px solid var(--line);
  background: #fff;
  border-radius: 16px;
  padding: 18px;
}
@media (max-width: 820px){ .hero{ grid-template-columns: 1fr; } }
.hero-video { width:100%; height: clamp(220px, 42vw, 60vh); object-fit: cover; border-radius: 12px; display:block; }
.hero-video.portrait  { aspect-ratio: 9 / 16;  max-height: 80vh; }
.hero-video.landscape { aspect-ratio: 16 / 9;  max-height: 60vh; }
.hero-text{ padding: 4px 6px; }
.hero-title{
  margin:0 0 6px;
  font-family: var(--font-serif);
  font-weight: 600; color: var(--navy);
  font-size: clamp(18px, 2.4vw, 24px);
}
.hero-body{ margin:0; color: var(--muted); line-height:1.65; }

/* Gold accent rule */
.rule{
  height:1px; background: linear-gradient(90deg, transparent, var(--gold), transparent);
  opacity:.7; margin: 6px 0 12px; border-radius:1px;
}

/* ===== Panel ===== */
.panel{
  background:#fff;
  border:1px solid var(--line);
  border-radius:16px;
  padding:22px;
}
.subtitle{
  margin:0 0 8px;
  color: var(--muted);
  font-size: 14px;
  letter-spacing:.2px;
  text-transform: uppercase;
}
.panel .prompt{
  white-space:pre-wrap;
  line-height:1.6;
  margin: 4px 0 12px;
  color: #111827;
}

/* Inputs & buttons */
.input{
  width:100%;
  padding:12px 14px;
  font-size:16px;
  color:#0b1220;
  background:#fff;
  border:1px solid var(--line);
  border-radius:10px;
  outline:none;
}
.input:focus{ border-color: var(--navy); box-shadow: 0 0 0 3px rgba(15,23,42,0.08); }
.button{
  display:inline-block;
  margin-top:12px;
  padding:10px 18px;
  font-size:16px;
  font-weight:600;
  color: var(--ink);
  background: linear-gradient(180deg, #fef7e6, #f7e7bb);
  border:1px solid var(--gold-deep);
  border-radius:10px;
  cursor:pointer;
}
.button:disabled{ opacity:.7; cursor:default }
.button:hover{ filter: saturate(1.05) brightness(1.02); }

/* Feedback */
.note-wrong{ margin-top:10px; color: var(--danger); }
.note-ok{
  margin-top:16px; padding:16px;
  background: #f1f7ff; border:1px solid #c7d2fe; border-radius:10px;
}

/* Links */
.link a{
  color: var(--navy); text-decoration: none;
  border-bottom: 1px solid rgba(15,23,42,0.18);
}
.link a:hover{ border-bottom-color: rgba(15,23,42,0.35); }

/* Footer */
.footer{ margin-top:18px; color: var(--muted); font-size: 14px; text-align:center; }

/* ===== Legacy Map Rail (safe to keep) ===== */
.map-rail { display: grid; gap: 18px; margin-top: 8px; position: relative; }
.node { display: grid; grid-template-columns: 24px 1fr; gap: 12px; align-items: start; }
.node-pin {
  width: 12px; height: 12px; border-radius: 50%; background: var(--gold);
  margin-top: 10px; box-shadow: 0 0 0 3px rgba(202, 165, 87, 0.18);
}
.node::before {
  content: ''; grid-column: 1; justify-self: center; width: 2px; height: 100%;
  background: linear-gradient(180deg, rgba(15, 23, 42, 0.1), rgba(15, 23, 42, 0.05));
}
.node:last-child::before { display: none; }
.node-card { background: #fff; border: 1px solid var(--line); border-radius: 12px; padding: 16px; width: 100%; }
.node-active .node-pin { background: var(--navy); }
.node-done .node-pin   { background: var(--gold); }
@media (max-width: 520px) { .node { grid-template-columns: 18px 1fr; } }

/* ===== Countdown (shared) ===== */
.cd-wrap { display:grid; gap:.75rem; justify-items:center; }
.cd-row { display:flex; align-items:center; gap:.5rem; }
.cd-unit { display:grid; gap:.25rem; justify-items:center; }
.cd-value {
  min-width: 64px; padding:.5rem .75rem;
  background:#caa557; color:#0f172a;
  border-radius:.375rem; font-weight:700;
  font-variant-numeric: tabular-nums; line-height:1;
}
.cd-label { font-size:.75rem; color:#334155; }
.cd-sep { font-weight:700; font-size:1.125rem; color:#334155; }
.countdown-title.themed { font-size:1.25rem; font-weight:700; margin-bottom:.25rem; }
.countdown-sub { font-size:.875rem; color:#475569; }

/* Compact variant (under the progress bar) */
.cd-compact .cd-value { min-width:56px; padding:.4rem .6rem; font-size:clamp(16px,2.4vw,22px); }
.cd-compact .cd-label { font-size:.7rem; }
.cd-compact .cd-sep { font-size:1rem; }

/* ===== Prelaunch theming & mobile fixes ===== */
.prelaunch { text-align: center; }
.prelaunch .countdown-title.themed {
  font-family: var(--font-serif);
  color: var(--navy);
  font-weight: 700; letter-spacing: .2px; margin-bottom: 14px;
}
.prelaunch .cd-value {
  background: linear-gradient(180deg, #fef7e6, #f7e7bb);
  border: 1px solid var(--gold-deep);
  color: var(--navy);
}
.prelaunch .cd-label { color: var(--navy); font-weight: 600; }
.prelaunch .cd-sep   { color: var(--gold); opacity: 1; }

.prelaunch .panel { background: #fff; border: 1px solid var(--line); border-radius: 16px; }
.prelaunch .countdown.full { background: linear-gradient(180deg, #fffef9, #ffffff); border: 1px solid var(--gold-deep); }

.prelaunch .page::before {
  content: ''; display: block; height: 6px; border-radius: 999px;
  background: linear-gradient(90deg, var(--gold), var(--navy)); opacity: .25;
}
.prelaunch-logo {
  display: block;
  margin: 10px auto 0;
  width: min(340px, 80vw);
  height: auto;
}

/* ===== Layout wrappers ===== */
.container{
  --pad-x: clamp(12px, 4vw, 24px);
  --pad-y: clamp(16px, 5vw, 32px);

  /* KEY FIX: avoid double scroll by subtracting vertical padding */
  min-height: calc(100svh - (var(--pad-y) * 2));

  display: flex;
  justify-content: center;
  padding-inline: var(--pad-x);
  padding-block: var(--pad-y);
  background:
    radial-gradient(1000px 600px at 120% -10%, rgba(15,23,42,0.06) 0%, rgba(15,23,42,0) 55%),
    radial-gradient(800px 500px at -10% -20%, rgba(202,165,87,0.06) 0%, rgba(202,165,87,0) 60%),
    var(--bg);
}


/* ========= Post-launch responsive helpers ========= */
@media (max-width: 520px) {
  .banner-inner { padding: 16px; }
  .hero { padding: 14px; gap: 14px; }
  .panel { padding: 16px; }
  .progress { padding: 22px 14px; }
}

/* Banner: stack neatly on narrow screens */
@media (max-width: 520px) {
  .banner-header {
    flex-wrap: wrap;
    justify-content: center;
    text-align: center;
  }
  .banner-logo { width: 40px; height: 40px; }
  .banner .rule { margin-left: auto; margin-right: auto; }
  .banner-title { font-size: clamp(20px, 6vw, 26px); }
}

/* Progress header can wrap without pushing layout */
@media (max-width: 420px) {
  .progress-header { flex-wrap: wrap; row-gap: 6px; }
}

/* Progress marks: smaller badges + tighter inset on tiny screens */
@media (max-width: 420px) {
  .progress-marks { left: 8px; right: 8px; }
  .progress .mark { width: 28px; height: 28px; }
  .progress .mark.mark-last { width: 32px; height: 32px; }
}

/* Compact countdown under the progress bar: scale down a touch */
@media (max-width: 420px) {
  .cd-compact .cd-value {
    min-width: 52px;
    padding: .35rem .5rem;
    font-size: clamp(15px, 3.5vw, 20px);
  }
  .cd-compact .cd-label { font-size: .66rem; }
  .cd-compact .cd-sep { font-size: .9rem; }
}

/* Hero video: keep visible without side scroll */
@media (max-width: 520px) {
  .hero-video { height: clamp(180px, 48vw, 46vh); }
}

/* General: ensure long words/links don’t cause overflow */
.banner-title,
.banner-sub,
.hero-body,
.subtitle {
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* Trim box size/spacing further on very small widths */
@media (max-width: 420px) {
  .prelaunch .cd-value {
    min-width: 56px;
    padding: 10px 12px;
    font-size: clamp(20px, 6.2vw, 28px);
  }
  .prelaunch .cd-unit { min-width: auto; }
  .cd-row { gap: .35rem; }
  .cd-sep { font-size: 1rem; }
}

/* Ultra small: hide separators if needed */
@media (max-width: 360px) {
  .prelaunch .cd-sep { display: none; }
}
/* Make root the only vertical scroller */
html { overflow-y: auto; }
body { overflow-y: auto; }

/* Ensure common wrappers don't create vertical scrollers */
.page, .filmstrip, .detail, .railWrap, .rail { overflow-y: visible !important; }
/* Root scroll only */
html { overflow-y: auto; height: auto; }
body { overflow-y: auto; height: auto; }

/* Next.js wrapper should NOT scroll */
#__next { height: auto; min-height: 100%; overflow: visible; }

/* Nuke inner vertical scrollers in common wrappers */
:where(.container, .page, .filmstrip, .detail, .railWrap, .rail) {
  height: auto !important;
  max-height: none !important;
  overflow-y: visible !important;
}
